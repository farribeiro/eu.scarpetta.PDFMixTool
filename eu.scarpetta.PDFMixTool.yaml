app-id: eu.scarpetta.PDFMixTool
runtime: org.kde.Platform
runtime-version: "5.14"
sdk: org.kde.Sdk
command: pdfmixtool
finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --device=dri
modules:
  - name: qpdf
    buildsystem: simple
    build-commands:
      - "./configure --prefix=/ --disable-static"
      - "make -j $FLATPAK_BUILDER_N_JOBS"
      - "make DESTDIR=$FLATPAK_DEST install"
    sources:
      - type: archive
        url: https://github.com/qpdf/qpdf/releases/download/release-qpdf-9.1.1/qpdf-9.1.1.tar.gz
        sha256: a2c6fc410ec45df0ca0996b039e00bb6f39cfc76d42d784b7ad7bc9e163f4236
    cleanup:
      - /include
      - /bin

  - name: podofo
    buildsystem: cmake-ninja
    config-opts:
      - -DPODOFO_BUILD_SHARED=1
      - -DPODOFO_BUILD_STATIC=0
      - -DPODOFO_HAVE_JPEG_LIB=1
      - -DPODOFO_HAVE_PNG_LIB=1
      - -DPODOFO_HAVE_TIFF_LIB=1
      - -DPODOFO_BUILD_LIB_ONLY=1
    sources:
      - type: archive
        url: https://downloads.sourceforge.net/podofo/podofo-0.9.6.tar.gz
        sha256: e9163650955ab8e4b9532e7aa43b841bac45701f7b0f9b793a98c8ca3ef14072
    cleanup:
      - /include
      - /lib/pkgconfig
      - /lib/debug/source

  - name: pdfmixtool
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
    sources:
      - type: archive
        url: https://gitlab.com/scarpetta/pdfmixtool/-/archive/52725021ee628a7e10f1b90b3d46acbbd922bdbe/pdfmixtool-52725021ee628a7e10f1b90b3d46acbbd922bdbe.tar.gz
        sha256: e2259d505e7448542b74bbb2a713364964593f40ff4efe428a306aa5a39ad4fc
